apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: managed-tools

resources:
  # Base resources - reference base files directly since Fleet processes bundles separately
  # Wazuh Indexer components
  - ../base/wazuh-indexer-configmap.yaml
  - ../base/wazuh-indexer-secret.yaml
  - ../base/wazuh-indexer-statefulset.yaml
  - ../base/wazuh-indexer-service.yaml
  
  # Wazuh Server (Manager) components
  - ../base/wazuh-server-configmap.yaml
  - ../base/wazuh-server-secret.yaml
  - ../base/wazuh-server-statefulset.yaml
  - ../base/wazuh-server-service.yaml
  
  # Wazuh Dashboard components
  - ../base/wazuh-dashboard-configmap.yaml
  - ../base/wazuh-dashboard-secret.yaml
  - ../base/wazuh-dashboard-deployment.yaml
  - ../base/wazuh-dashboard-service.yaml
  - ../base/wazuh-dashboard-ingress.yaml

# Cluster-specific patches for nprd-apps
patches:
  # Storage class patch - set truenas-nfs for all PVCs
  - path: storage-class-patch.yaml
  # Resource limits patch - adjust based on cluster capacity
  - path: resource-limits-patch.yaml

commonLabels:
  app: wazuh
  managed-by: gitops
